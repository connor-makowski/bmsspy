\begin{algorithm}[!htbp]
\SingleSpacedXI
\caption{{\color{Bittersweet}BMSSP Solve (\texttt{BmsspCore.\_\_init\_\_} \& \texttt{Bmssp.solve})}}
\label{alg:bmssp_init}
\SetAlgoLined
\KwIn{origin set $O$, destination id $dest$ (optional)}
\KwOut{dictionary with path, length, distance matrix, and predecessor}

$\textit{dist}[0..|G|-1] \leftarrow \infty$\;
{\color{Sepia}$\textit{cdist}[0..|G|-1] \leftarrow \infty$ \tcp*{Counter distance matrix}\label{alg:bmssp_init_cdist}}
{\color{ForestGreen}$\textit{pred}[0..|G|-1] \leftarrow -1$ \tcp*{Track predecessors for path reconstruction}\label{alg:bmssp_init_pred}}

\ForEach{$o \in O$}{
  $\textit{dist}[o] \leftarrow 0$\;
  {\color{Sepia}$\textit{cdist}[o] \leftarrow 0$\;}
}

\BlankLine
{\color{blue}$k \leftarrow \lfloor \log_2(|G|)^{1/3} \rfloor$ \tcp*{Use $log_2$}\label{alg:bmssp_init_k}}

{\color{blue}$t \leftarrow \lfloor \log_2(|G|)^{2/3} \rfloor$ \tcp*{Use $log_2$}\label{alg:bmssp_init_t}}
{\color{blue}$l \leftarrow \left\lceil \dfrac{\log_2(|G|)}{t} \right\rceil$\  \tcp*{Use $log_2$}\label{alg:bmssp_init_l}}

\BlankLine
$(B, U) \leftarrow$ \textsc{RecursiveBMSSP}($l, \infty, O$)\;

\BlankLine
{\color{Sepia}
  \ForEach{$i \in \textit{cdist}$}{
    \If{$\textit{cdist}[i] \neq \infty$}{
      $\textit{cdist}[i] \leftarrow \text{round}(\textit{cdist}[i], p)$\tcp*{Convert back to original precision}\label{alg:bmssp_solve_precision_adjustment}
    }
  }
}

\BlankLine
{\color{Bittersweet}
  \eIf{$dest \neq \text{None}$}{
    {\color{ForestGreen}$\textit{path} \leftarrow \textsc{ReconstructPath}(dest, \textit{pred})$\;}
    $\textit{length} \leftarrow \textit{dist}[dest]$\;
  }{
    {\color{ForestGreen}$\textit{path} \leftarrow \text{None}$\;}
    $\textit{length} \leftarrow \text{None}$\;
  }
}

\BlankLine
\Return dictionary with keys: $O$, $dest$, $\textit{pred}$, $\textit{dist}$, $\textit{path}$, $\textit{length}$\;

\end{algorithm}