\begin{algorithm}[!htbp]
\SingleSpacedXI
\caption{Base Case (\texttt{BmsspCore.base\_case})}
\label{alg:bmssp_base_case}
\SetAlgoLined
\KwIn{upper bound $B$, singleton frontier $S$}
\KwOut{new bound $B'$, new frontier $S'$}
$Heap \leftarrow \textsc{BinaryHeap}((\textit{dist}[x],x))$; $S' \leftarrow \emptyset$; $B' \leftarrow B$\;
\While{$Heap\neq\emptyset$}{
  $(d,u) \leftarrow Heap.ExtractMin()$\;
  {\color{Fuchsia} \If{$|S'| \geq k$}{
    $B' \leftarrow d$; \textbf{break}\tcp*{Early termination}\label{alg:bmssp_base_case_early_break}
  }}
  $S'\leftarrow S'\cup\{u\}$\;
  \ForEach{$(v,w)\in G[u]$}{
    {\color{Sepia}$d'\leftarrow \textit{cdist}[u] + w + counter + G_{edge}[u][v]$\tcp*{Unique distance}\label{alg:bmssp_base_case_modified_distance}}
    \If{$d'\le \textit{dist}[v]$ \textbf{and} $d'<B$}{
      $\textit{dist}[v]\leftarrow d'$\;
      {\color{ForestGreen}$\textit{pred}[v]\leftarrow u$\tcp*{Update predecessor}\label{alg:bmssp_base_case_pred}}
      {\color{Sepia}$\textit{cdist}[v]\leftarrow \textit{cdist}[u] + w + counter$\tcp*{Update counter distance}\label{alg:bmssp_base_case_counter_dist_update}}
      $Heap.InsertOrDecreaseKey(v,d')$\;\label{alg:bmssp_base_case_push}
    }
  }
}
\Return{$(B',S')$}\;
\end{algorithm}